let listmapi low high result xs =
  List.mapi (fun i row ->
    if i <> low then
      row
    else
        row |> List.mapi (fun j x -> if j <> high then x else result)) xs

let rec minimal_demo dp low high =
  if low >= high then
    (dp, 0)
  else
    let dp', result = minimal_demo dp (low + 1) high in
    let updated_dp =
        dp' |> listmapi low high result
    in
    (updated_dp, result)
(* [@@measure Ordinal.of_int (high - low)] *)
